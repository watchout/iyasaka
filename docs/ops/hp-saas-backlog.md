# HP SaaS 開発バックログ

> **目的**: IYASAKAを灯台テナントとして最小公開し、その実装をSaaSに一般化する
> 
> **マスター仕様書**: [`docs/ssot/HP_SAAS_MASTER_SPEC.md`](../ssot/HP_SAAS_MASTER_SPEC.md)

---

## ステータス定義

| ステータス | 意味 |
|-----------|------|
| `done` | 実装・リリース済み |
| `in_progress` | 実装中 |
| `planned` | 実装予定（合意済み） |
| `proposed` | 提案中（優先度未決） |
| `blocked` | ブロック中（依存あり） |

---

## Phase 1: IYASAKAソフトローンチ【Now】

**期間**: 0〜2週間  
**目標**: 営業に使える状態 + SaaS要件の確定  
**方針**: 完璧は捨てる（デザイン磨き込み・記事量産は後回し）

### [P1-001] 6ページタイプの確認・整備

- **status**: done
- **context**: `HP_SAAS_MASTER_SPEC.md`, `AIEO_REQUIREMENTS_SPEC.md`, `BRAND_MASTER_PROTOCOL.md`
- **概要**: HP SaaS仕様の6ページタイプがIYASAKAで揃っているか確認し、不足を補完

| ページタイプ | 現状 | 対応 |
|-------------|------|------|
| サービスLP | ✅ `pages/products/[slug].vue` | 確認済み |
| 実績・事例 | ✅ `pages/cases/` | 確認済み |
| FAQ | ✅ `pages/faq.vue` | 作成済み |
| 会社・代表 | ✅ `pages/company/` | 確認済み |
| お知らせ・PR | ✅ `pages/news/` | 確認済み |
| 問い合わせ | ✅ `pages/contact/` | 確認済み |

**タスク**:
- [x] FAQページ `/faq` の作成（HP SaaS仕様に準拠）- 2026-01-16完了
- [x] 各ページの動作確認 - 2026-01-20完了

---

### [P1-002] リード獲得フローの完全動作確認

- **status**: done
- **context**: `LEAD_CAPTURE_PROTOCOL.md`, `CONTACT_FORM_SPEC.md`
- **概要**: フォーム送信→Supabase保存→通知の一連のフローをテスト

**タスク**:
- [x] 開発環境でのフォーム送信テスト - 2026-01-20 APIテスト成功
- [x] Supabaseへのリード保存確認 - 2026-01-20 確認済み
- [ ] Slack通知の設定・テスト（`SLACK_LEAD_WEBHOOK` 設定）- MVPではスキップ
- [x] メール通知の設定・テスト（`LEAD_MAIL_*` 設定）- P1-003で設定予定
- [x] サンクスページへの遷移確認 - 2026-01-20 確認済み

---

### [P1-003] 環境変数の本番設定

- **status**: planned
- **context**: `PRODUCTION_ENV_GUIDE.md`
- **概要**: 本番環境で必要な環境変数を設定

| 変数 | 現状 | 対応 |
|------|------|------|
| `SUPABASE_URL` | ✅ 設定済み | - |
| `SUPABASE_SERVICE_KEY` | ✅ 設定済み | - |
| `SLACK_LEAD_WEBHOOK` | ❌ 未設定 | 設定必要 |
| `LEAD_MAIL_HOST` | ❌ 未設定 | 設定必要 |
| `LEAD_MAIL_USER` | ❌ 未設定 | 設定必要 |
| `LEAD_MAIL_PASS` | ❌ 未設定 | 設定必要 |
| `LEAD_MAIL_FROM` | ❌ 未設定 | 設定必要 |
| `LEAD_MAIL_TO` | ❌ 未設定 | 設定必要 |
| `NUXT_PUBLIC_SITE_URL` | ❌ 未設定 | `https://iyasaka.co.jp` |

---

### [P1-004] 計測設定

- **status**: planned
- **概要**: 最低限の計測を設定

**タスク**:
- [ ] Plausible Analytics ゴール設定
  - フォームCV（`lead_submit`）
  - 主要ページ閲覧
  - 流入元
- [ ] イベント発火の動作確認

---

### [P1-005] 信頼ページの確認・強化

- **status**: planned
- **概要**: 信頼性を高めるページの確認

**チェックリスト**:
- [ ] 代表プロフィール（固有名詞・年・実績）
- [ ] 実績数値（導入件数・対応範囲）
- [ ] 問い合わせ導線の明確さ
- [ ] 会社概要の完全性

---

### [P1-006] ソフトローンチ判定

- **status**: blocked
- **依存**: P1-001〜P1-005完了
- **概要**: ソフトローンチ可能かの最終判定

**判定基準**:
- [ ] 6ページタイプがすべて公開可能
- [ ] リード獲得フローが動作
- [ ] 計測が動作
- [ ] 致命的なバグがない

---

## Phase 2: SaaSコア構築【Next】

**期間**: 3〜6週間  
**目標**: 東海電業社が同じ仕組みで立ち上がる  
**方針**: 最小限のマルチテナント機能を実装

### [P2-001] マルチテナントDB設計

- **status**: proposed
- **概要**: テナント分離のためのDB設計・RLS設定

**タスク**:
- [ ] `tenants` テーブル作成
- [ ] `users` テーブル作成（テナント所属）
- [ ] 既存 `leads` テーブルに `tenant_id` 追加
- [ ] RLS（Row Level Security）ポリシー設定
- [ ] IYASAKAを「テナント0」として登録

---

### [P2-002] 認証基盤

- **status**: proposed
- **概要**: Supabase Authを使用したテナント認証

**タスク**:
- [ ] Supabase Auth設定
- [ ] ログイン/ログアウト機能
- [ ] テナント別権限管理（owner/admin/editor/viewer）
- [ ] セッション管理

---

### [P2-003] 管理画面（最小版）

- **status**: proposed
- **概要**: テナント管理者向けの最小管理画面

**タスク**:
- [ ] ダッシュボード（リード数・PV概要）
- [ ] ページ一覧
- [ ] ページ編集（draft/preview/publish）
- [ ] リード一覧
- [ ] CSV出力

---

### [P2-004] pagesテーブル統合

- **status**: proposed
- **概要**: 6ページタイプを統一テーブルで管理

**タスク**:
- [ ] `pages` テーブル作成（Single Table Inheritance）
- [ ] ページタイプごとのJSONスキーマ定義
- [ ] 既存IYASAKAコンテンツの移行

---

### [P2-005] 東海電業社テナント作成

- **status**: proposed
- **概要**: 2社目のテナントとして東海電業社を追加

**タスク**:
- [ ] テナント登録
- [ ] 電気工事業テンプレート適用
- [ ] コンテンツ入力（6ページタイプ）
- [ ] 公開・動作確認

---

### [P2-006] SaaSコア完成判定

- **status**: blocked
- **依存**: P2-001〜P2-005完了
- **概要**: 2社が同一コードベースで稼働することを確認

**判定基準**:
- [ ] IYASAKA が稼働
- [ ] 東海電業社 が稼働
- [ ] どちらも6ページタイプを公開
- [ ] リードが別々に管理される
- [ ] 管理画面から編集・公開可能

---

## Phase 3: 製品化【Later】

**期間**: 7週間〜  
**目標**: 他社販売の再現性を確立  
**方針**: 業種パック化・課金・オンボーディング

### [P3-001] 業種パック（電気工事）

- **status**: proposed
- **概要**: 電気工事業向けテンプレートをパック化

**タスク**:
- [ ] テンプレートコンテンツ整備
- [ ] デザインバリエーション
- [ ] 導入ガイド作成

---

### [P3-002] AIコンテンツ生成（オプション）

- **status**: proposed
- **概要**: AIによる記事・LP生成機能

**タスク**:
- [ ] ブランドボイス学習
- [ ] 記事生成API
- [ ] LP生成API
- [ ] 生成→編集→公開フロー

---

### [P3-003] AIEO最適化エンジン

- **status**: proposed
- **概要**: AI検索エンジン最適化機能

**タスク**:
- [ ] 構造化データ自動生成
- [ ] FAQ自動生成
- [ ] AIEOスコア算出
- [ ] 改善提案

---

### [P3-004] Stripe課金連携

- **status**: proposed
- **概要**: サブスクリプション課金

**タスク**:
- [ ] Stripe連携
- [ ] プラン管理（Starter/Growth/Pro）
- [ ] 請求書発行
- [ ] 解約フロー

---

### [P3-005] オンボーディングフロー

- **status**: proposed
- **概要**: 新規テナントのセルフオンボーディング

**タスク**:
- [ ] アカウント作成フロー
- [ ] テンプレート選択
- [ ] 初期設定ウィザード
- [ ] ヘルプドキュメント

---

## Done（完了済み）

### [DONE-001] HP SaaS マスター仕様書作成

- **完了日**: 2026-01-16
- **成果物**: `docs/ssot/HP_SAAS_MASTER_SPEC.md`
- **内容**: 
  - 6ページタイプ定義
  - データモデル設計
  - 公開フローと権限
  - AIEO仕様

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-01-16 | 初版作成 |

---

*このバックログはHP SaaS開発のタスク管理における唯一の正本（SSOT）です。*
